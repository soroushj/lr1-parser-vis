!function(){function e(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var t;function r(r){var n,a,i,o,l,c,d,h,p=function(e){return e[e.length-1]},s=function(e,t){return e.rule===t.rule&&e.position===t.position&&e.lookahead===t.lookahead},u=function(e,t){if(e.length!==t.length)return!1;for(var r=[],n=0;n<e.length;++n)for(var a=0;a<e.length;++a)!r.includes(a)&&s(e[n],t[a])&&r.push(a);return r.length===e.length},f=function(e,t){if(e.type!==t.type)return!1;switch(e.type){case"accept":return!0;case"shift":return e.state===t.state;case"reduce":return e.rule===t.rule;case"conflict":return!1}},v=function(e){return e>=a&&e<n.length-1},m=function(e){if(function(e){return e>=a&&e<n.length}(e))return[e];for(var t=[],r=0;r<o.length;++r)if(o[r].lhs===e&&o[r].rhs[0]!==e)for(var i=m(o[r].rhs[0]),l=0;l<i.length;++l)t.push(i[l]);return t},g=function(e){for(var t=e.slice(0),r=!0;r;){r=!1;for(var n=0;n<t.length;++n)for(var a=t[n].rule.rhs[t[n].position],i=0;i<o.length;++i)if(o[i].lhs===a)for(var l=m(t[n].position+1<t[n].rule.rhs.length?t[n].rule.rhs[t[n].position+1]:t[n].lookahead),c=0;c<l.length;++c){for(var d={rule:o[i],position:0,lookahead:l[c]},h=!0,p=0;p<t.length;++p)if(s(t[p],d)){h=!1;break}h&&(t.push(d),r=!0)}}return t},y=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n].rule.rhs[e[n].position]===t&&r.push({rule:e[n].rule,position:e[n].position+1,lookahead:e[n].lookahead});return g(r)},E=function(e,t){if(e.symbol===t.lhs&&0===e.children.length){for(var r=0;r<t.rhs.length;++r)e.children.push({symbol:t.rhs[r],children:[]});return!0}for(r=e.children.length-1;r>=0;--r)if(E(e.children[r],t))return!0;return!1},C=function(e,t,r){if(void 0===c[e][t])c[e][t]=r;else if("conflict"===c[e][t].type){for(var n=!0,a=0;a<c[e][t].actions.length;++a)if(f(c[e][t].actions[a],r)){n=!1;break}n&&c[e][t].actions.push(r)}else f(c[e][t],r)||(c[e][t]={type:"conflict",actions:[c[e][t],r]},d=!0)};this.createParser=function(e){n=[];for(var t=e.trim().split(/[\r\n]+/),r=[],h=0;h<t.length;++h)r[h]=t[h].trim().split(/\s+/),n.includes(r[h][0])||n.push(r[h][0]);a=n.length;for(var p=0;p<r.length;++p)for(var s=0;s<r[p].length;++s)n.includes(r[p][s])||n.push(r[p][s]);i=n.length,n.push("$"),o=[];for(var f=0;f<r.length;++f){o[f]={index:f,rhs:[]};for(s=0;s<r[f].length;++s)0===s?o[f].lhs=n.indexOf(r[f][s]):o[f].rhs.push(n.indexOf(r[f][s]))}!function(){l=[g([{rule:o[0],position:0,lookahead:i}])];for(var e=!0;e;){e=!1;for(var t=0;t<l.length;++t)for(var r=1;r<n.length-1;++r){var a=y(l[t],r);if(0!==a.length){for(var c=!0,d=0;d<l.length;++d)if(u(l[d],a)){c=!1;break}c&&(l.push(a),e=!0)}}}}(),function(){c=new Array(l.length),d=!1;for(var e=0;e<l.length;++e){c[e]=new Array(n.length);for(var t=0;t<l[e].length;++t){var r=l[e][t].rule.rhs[l[e][t].position];if(v(r))for(var o=y(l[e],r),h=0;h<l.length;++h)u(l[h],o)&&C(e,r,{type:"shift",state:h});l[e][t].position===l[e][t].rule.rhs.length&&(0!==l[e][t].rule.lhs?C(e,l[e][t].lookahead,{type:"reduce",rule:l[e][t].rule}):l[e][t].lookahead===i&&(c[e][i]={type:"accept"}))}for(r=1;r<a;++r)for(o=y(l[e],r),h=0;h<l.length;++h)u(l[h],o)&&(c[e][r]=h)}}()},this.parse=function(e){if(void 0!==c)if(h=[],d)h.push({stateStack:[],symbolStack:[],input:[],action:{type:"error",error:"conflict in parse table"}});else{var t=function(e){for(var t=e.trim().split(/\s+/),r=[],a=0;a<t.length;++a){var o=n.indexOf(t[a]);if(!v(o))return!1;r.push(o)}return r.push(i),r}(e);if(!1!==t)for(var r=[0],a=[];;){var o=c[p(r)][t[0]];switch(void 0===o&&(o={type:"error",error:"parse error"}),h.push({stateStack:r.slice(0),symbolStack:a.slice(0),input:t.slice(0),action:o}),o.type){case"shift":a.push(t.shift()),r.push(o.state);break;case"reduce":for(var l=0;l<o.rule.rhs.length;++l)a.pop(),r.pop();a.push(o.rule.lhs),r.push(c[p(r)][o.rule.lhs]);break;case"accept":case"error":return}}else h.push({stateStack:[],symbolStack:[],input:[],action:{type:"error",error:"syntax error"}})}},this.clear=function(){n=a=i=o=l=c=d=h=void 0};var b=function(e){switch(e.type){case"accept":return"acc";case"shift":return"s"+e.state;case"reduce":return"r"+e.rule.index;case"error":return"error: "+e.error;case"conflict":for(var t=b(e.actions[0]),r=1;r<e.actions.length;++r)t+=","+b(e.actions[r]);return t}},k=function(e){return 0===e?"start-symbol":e===i?"end-marker":function(e){return e<a&&e>0}(e)?"non-terminal":v(e)?"terminal":void 0},T=function(){return r.createTextNode(" → ")},S=function(){return r.createTextNode("•")},x=function(n,a,i,o){var l=r.createElement(n);return(void 0===a?[]:Array.isArray(a)?a:[a]).forEach((function(e){"object"==typeof e?l.appendChild(e):l.appendChild(r.createTextNode(e))})),void 0!==i&&(Array.isArray(i)?(t=l.classList).add.apply(t,e(i)):l.classList.add(i)),void 0!==o&&Object.keys(o).forEach((function(e){l[e]=o[e]})),l},I=function(e,t){var r=[k(e)];return void 0!==t&&r.push(t),x("b",n[e],r)},L=function(e){return e.map((function(e){return I(e)}))},w=function(t){return[I(t.lhs),T()].concat(e(L(t.rhs)))},A=function(e){if(void 0!==e){var t=r.createElement("ul"),a=r.createElement("li");a.classList.add(k(e.symbol)),t.appendChild(a);var i=r.createElement("span");return i.appendChild(r.createTextNode(n[e.symbol])),a.appendChild(i),e.children.forEach((function(e){var r=A(e);void 0!==r&&t.appendChild(r)})),t}};this.renderGrammar=function(e){if(e.innerHTML="",void 0!==n){var t=r.createElement("pre");o.forEach((function(e,n){t.appendChild(x("i",n+" ")),w(e).forEach((function(e){t.appendChild(e)})),n!==o.length-1&&t.appendChild(r.createElement("br"))})),e.appendChild(t)}},this.renderCollection=function(e){if(e.innerHTML="",void 0!==l){var t=r.createElement("pre");l.forEach((function(e,n){e.forEach((function(a,i){t.appendChild(x("i",0===i?["I",x("sub",n)," "]:void 0)),function(e){var t=[I(e.rule.lhs),T()];return e.rule.rhs.forEach((function(r,n){e.position===n&&t.push(S()),t.push(I(r))})),e.position===e.rule.rhs.length&&t.push(S()),t.push(r.createTextNode(",")),t.push(I(e.lookahead,"lookahead")),t}(a).forEach((function(e){t.appendChild(e)})),i!==e.length-1&&t.appendChild(r.createElement("br"))})),n!==l.length-1&&(t.appendChild(r.createElement("br")),t.appendChild(r.createElement("br")))})),e.appendChild(t)}},this.renderParseTable=function(e){if(e.innerHTML="",void 0!==c){var t=r.createElement("table"),o=r.createElement("thead");t.appendChild(o);var l=r.createElement("tr");o.appendChild(l);var d=r.createElement("tr");o.appendChild(d);var h=r.createElement("tbody");t.appendChild(h),l.appendChild(x("th","state",void 0,{rowSpan:2})),l.appendChild(x("th","action",void 0,{colSpan:n.length-a})),l.appendChild(x("th","goto",void 0,{colSpan:a-1}));for(var p=a;p<n.length;++p){var s=["action"];p===i&&s.push("end-marker"),d.appendChild(x("th",n[p],s))}for(var u=1;u<a;++u)d.appendChild(x("th",n[u],"goto"));for(var f=0;f<c.length;++f){var v=r.createElement("tr");h.appendChild(v),v.appendChild(x("td",f));for(var m=a;m<n.length;++m)void 0===c[f][m]?v.appendChild(x("td",void 0,"error")):v.appendChild(x("td",b(c[f][m]),c[f][m].type));for(var g=1;g<a;++g)v.appendChild(x("td",c[f][g]))}e.appendChild(t)}},this.renderParseSteps=function(e){if(e.innerHTML="",void 0!==h){var t=r.createElement("table"),n=r.createElement("thead");t.appendChild(n);var a=r.createElement("tr");n.appendChild(a);var i=r.createElement("tbody");t.appendChild(i),a.appendChild(x("th","state stack")),a.appendChild(x("th","symbol stack")),a.appendChild(x("th","input")),a.appendChild(x("th","action")),a.appendChild(x("th","output")),h.forEach((function(e){var t=r.createElement("tr");i.appendChild(t),t.appendChild(x("td",r.createTextNode(e.stateStack.join(" ")))),t.appendChild(x("td",L(e.symbolStack))),t.appendChild(x("td",L(e.input))),t.appendChild(x("td",b(e.action),e.action.type)),t.appendChild(x("td","reduce"===e.action.type?w(e.action.rule):void 0))})),e.appendChild(t)}},this.renderParseTree=function(e){if(e.innerHTML="",void 0!==h){var t=A(function(){for(var e,t=h.length-1;t>=0;--t)"reduce"===h[t].action.type&&(void 0===e&&(e={symbol:h[t].action.rule.lhs,children:[]}),E(e,h[t].action.rule));return e}());void 0!==t&&e.appendChild(t)}},this.sampleGrammar=function(){return"S' G\nG E = E\nG id\nE E + T\nE T\nT T * id\nT id"},this.sampleInput=function(){return"id = id + id * id"}}document.addEventListener("DOMContentLoaded",(function(){var e=new r(document),t=document.getElementById("grammar-text"),n=document.getElementById("input-text"),a={grammar:document.getElementById("grammar-container"),collection:document.getElementById("collection-container"),parseTable:document.getElementById("parse-table-container"),parseSteps:document.getElementById("parse-steps-container"),parseTree:document.getElementById("parse-tree-container")},i=function(){Object.keys(a).forEach((function(e){a[e].innerHTML=""}))},o=function(){i(),e.createParser(t.value),e.renderGrammar(a.grammar),e.renderCollection(a.collection),e.renderParseTable(a.parseTable)},l=function(){e.parse(n.value),e.renderParseSteps(a.parseSteps),e.renderParseTree(a.parseTree)};document.getElementById("create-parser").addEventListener("click",o),document.getElementById("parse").addEventListener("click",l),document.getElementById("show-example").addEventListener("click",(function(){t.value=e.sampleGrammar(),o(),n.value=e.sampleInput(),l()})),document.getElementById("clear").addEventListener("click",(function(){t.value="",n.value="",i(),e.clear()}))}))}();
//# sourceMappingURL=index.4dcef67b.js.map
