!function(){function e(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function r(r){var t,n,a,i,o,l,c,d,h=function(e){return e[e.length-1]},p=function(e,r){return e.rule===r.rule&&e.position===r.position&&e.lookahead===r.lookahead},s=function(e,r){if(e.length!==r.length)return!1;for(var t=[],n=0;n<e.length;++n)for(var a=0;a<e.length;++a)!t.includes(a)&&p(e[n],r[a])&&t.push(a);return t.length===e.length},u=function(e,r){if(e.type!==r.type)return!1;switch(e.type){case"accept":return!0;case"shift":return e.state===r.state;case"reduce":return e.rule===r.rule;case"conflict":return!1}},f=function(e){return e>=n&&e<t.length-1},v=function(e){if(function(e){return e>=n&&e<t.length}(e))return[e];for(var r=[],a=0;a<i.length;++a)if(i[a].lhs===e&&i[a].rhs[0]!==e)for(var o=v(i[a].rhs[0]),l=0;l<o.length;++l)r.push(o[l]);return r},m=function(e){for(var r=e.slice(0),t=!0;t;){t=!1;for(var n=0;n<r.length;++n)for(var a=r[n].rule.rhs[r[n].position],o=0;o<i.length;++o)if(i[o].lhs===a)for(var l=v(r[n].position+1<r[n].rule.rhs.length?r[n].rule.rhs[r[n].position+1]:r[n].lookahead),c=0;c<l.length;++c){for(var d={rule:i[o],position:0,lookahead:l[c]},h=!0,s=0;s<r.length;++s)if(p(r[s],d)){h=!1;break}h&&(r.push(d),t=!0)}}return r},g=function(e,r){for(var t=[],n=0;n<e.length;++n)e[n].rule.rhs[e[n].position]===r&&t.push({rule:e[n].rule,position:e[n].position+1,lookahead:e[n].lookahead});return m(t)},y=function(e,r){if(e.symbol===r.lhs&&0===e.children.length){for(var t=0;t<r.rhs.length;++t)e.children.push({symbol:r.rhs[t],children:[]});return!0}for(var n=e.children.length-1;n>=0;--n)if(y(e.children[n],r))return!0;return!1},E=function(e,r,t){if(void 0===l[e][r])l[e][r]=t;else if("conflict"===l[e][r].type){for(var n=!0,a=0;a<l[e][r].actions.length;++a)if(u(l[e][r].actions[a],t)){n=!1;break}n&&l[e][r].actions.push(t)}else u(l[e][r],t)||(l[e][r]={type:"conflict",actions:[l[e][r],t]},c=!0)};this.createParser=function(e){t=[];for(var r=e.trim().split(/[\r\n]+/),d=[],h=0;h<r.length;++h)d[h]=r[h].trim().split(/\s+/),t.includes(d[h][0])||t.push(d[h][0]);n=t.length;for(var p=0;p<d.length;++p)for(var u=0;u<d[p].length;++u)t.includes(d[p][u])||t.push(d[p][u]);a=t.length,t.push("$"),i=[];for(var v=0;v<d.length;++v){i[v]={index:v,rhs:[]};for(var y=0;y<d[v].length;++y)0===y?i[v].lhs=t.indexOf(d[v][y]):i[v].rhs.push(t.indexOf(d[v][y]))}!function(){o=[m([{rule:i[0],position:0,lookahead:a}])];for(var e=!0;e;){e=!1;for(var r=0;r<o.length;++r)for(var n=1;n<t.length-1;++n){var l=g(o[r],n);if(0!==l.length){for(var c=!0,d=0;d<o.length;++d)if(s(o[d],l)){c=!1;break}c&&(o.push(l),e=!0)}}}}(),function(){l=new Array(o.length),c=!1;for(var e=0;e<o.length;++e){l[e]=new Array(t.length);for(var r=0;r<o[e].length;++r){var i=o[e][r].rule.rhs[o[e][r].position];if(f(i))for(var d=g(o[e],i),h=0;h<o.length;++h)s(o[h],d)&&E(e,i,{type:"shift",state:h});o[e][r].position===o[e][r].rule.rhs.length&&(0!==o[e][r].rule.lhs?E(e,o[e][r].lookahead,{type:"reduce",rule:o[e][r].rule}):o[e][r].lookahead===a&&(l[e][a]={type:"accept"}))}for(var p=1;p<n;++p)for(var u=g(o[e],p),v=0;v<o.length;++v)s(o[v],u)&&(l[e][p]=v)}}()},this.parse=function(e){if(void 0!==l)if(d=[],c)d.push({stateStack:[],symbolStack:[],input:[],action:{type:"error",error:"conflict in parse table"}});else{var r=function(e){for(var r=e.trim().split(/\s+/),n=[],i=0;i<r.length;++i){var o=t.indexOf(r[i]);if(!f(o))return!1;n.push(o)}return n.push(a),n}(e);if(!1!==r)for(var n=[0],i=[];;){var o=l[h(n)][r[0]];switch(void 0===o&&(o={type:"error",error:"parse error"}),d.push({stateStack:n.slice(0),symbolStack:i.slice(0),input:r.slice(0),action:o}),o.type){case"shift":i.push(r.shift()),n.push(o.state);break;case"reduce":for(var p=0;p<o.rule.rhs.length;++p)i.pop(),n.pop();i.push(o.rule.lhs),n.push(l[h(n)][o.rule.lhs]);break;case"accept":case"error":return}}else d.push({stateStack:[],symbolStack:[],input:[],action:{type:"error",error:"syntax error"}})}},this.clear=function(){t=n=a=i=o=l=c=d=void 0};var C=function(e){switch(e.type){case"accept":return"acc";case"shift":return"s"+e.state;case"reduce":return"r"+e.rule.index;case"error":return"error: "+e.error;case"conflict":for(var r=C(e.actions[0]),t=1;t<e.actions.length;++t)r+=","+C(e.actions[t]);return r}},b=function(e){return 0===e?"start-symbol":e===a?"end-marker":function(e){return e<n&&e>0}(e)?"non-terminal":f(e)?"terminal":void 0},k=function(){return r.createTextNode(" → ")},T=function(){return r.createTextNode("•")},S=function(t,n,a,i){var o,l=r.createElement(t);((void 0===n?[]:Array.isArray(n)?n:[n]).forEach((function(e){"object"==typeof e?l.appendChild(e):l.appendChild(r.createTextNode(e))})),void 0!==a)&&(Array.isArray(a)?(o=l.classList).add.apply(o,e(a)):l.classList.add(a));return void 0!==i&&Object.keys(i).forEach((function(e){l[e]=i[e]})),l},x=function(e,r){var n=[b(e)];return void 0!==r&&n.push(r),S("b",t[e],n)},I=function(e){return e.map((function(e){return x(e)}))},L=function(r){return[x(r.lhs),k()].concat(e(I(r.rhs)))},w=function(e){if(void 0!==e){var n=r.createElement("ul"),a=r.createElement("li");a.classList.add(b(e.symbol)),n.appendChild(a);var i=r.createElement("span");return i.appendChild(r.createTextNode(t[e.symbol])),a.appendChild(i),e.children.forEach((function(e){var r=w(e);void 0!==r&&n.appendChild(r)})),n}};this.renderGrammar=function(e){if(e.innerHTML="",void 0!==t){var n=r.createElement("pre");i.forEach((function(e,t){n.appendChild(S("i",t+" ")),L(e).forEach((function(e){n.appendChild(e)})),t!==i.length-1&&n.appendChild(r.createElement("br"))})),e.appendChild(n)}},this.renderCollection=function(e){if(e.innerHTML="",void 0!==o){var t=r.createElement("pre");o.forEach((function(e,n){e.forEach((function(a,i){t.appendChild(S("i",0===i?["I",S("sub",n)," "]:void 0)),function(e){var t=[x(e.rule.lhs),k()];return e.rule.rhs.forEach((function(r,n){e.position===n&&t.push(T()),t.push(x(r))})),e.position===e.rule.rhs.length&&t.push(T()),t.push(r.createTextNode(",")),t.push(x(e.lookahead,"lookahead")),t}(a).forEach((function(e){t.appendChild(e)})),i!==e.length-1&&t.appendChild(r.createElement("br"))})),n!==o.length-1&&(t.appendChild(r.createElement("br")),t.appendChild(r.createElement("br")))})),e.appendChild(t)}},this.renderParseTable=function(e){if(e.innerHTML="",void 0!==l){var i=r.createElement("table"),o=r.createElement("thead");i.appendChild(o);var c=r.createElement("tr");o.appendChild(c);var d=r.createElement("tr");o.appendChild(d);var h=r.createElement("tbody");i.appendChild(h),c.appendChild(S("th","state",void 0,{rowSpan:2})),c.appendChild(S("th","action",void 0,{colSpan:t.length-n})),c.appendChild(S("th","goto",void 0,{colSpan:n-1}));for(var p=n;p<t.length;++p){var s=["action"];p===a&&s.push("end-marker"),d.appendChild(S("th",t[p],s))}for(var u=1;u<n;++u)d.appendChild(S("th",t[u],"goto"));for(var f=0;f<l.length;++f){var v=r.createElement("tr");h.appendChild(v),v.appendChild(S("td",f));for(var m=n;m<t.length;++m)void 0===l[f][m]?v.appendChild(S("td",void 0,"error")):v.appendChild(S("td",C(l[f][m]),l[f][m].type));for(var g=1;g<n;++g)v.appendChild(S("td",l[f][g]))}e.appendChild(i)}},this.renderParseSteps=function(e){if(e.innerHTML="",void 0!==d){var t=r.createElement("table"),n=r.createElement("thead");t.appendChild(n);var a=r.createElement("tr");n.appendChild(a);var i=r.createElement("tbody");t.appendChild(i),a.appendChild(S("th","state stack")),a.appendChild(S("th","symbol stack")),a.appendChild(S("th","input")),a.appendChild(S("th","action")),a.appendChild(S("th","output")),d.forEach((function(e){var t=r.createElement("tr");i.appendChild(t),t.appendChild(S("td",r.createTextNode(e.stateStack.join(" ")))),t.appendChild(S("td",I(e.symbolStack))),t.appendChild(S("td",I(e.input))),t.appendChild(S("td",C(e.action),e.action.type)),t.appendChild(S("td","reduce"===e.action.type?L(e.action.rule):void 0))})),e.appendChild(t)}},this.renderParseTree=function(e){if(e.innerHTML="",void 0!==d){var r=w(function(){for(var e,r=d.length-1;r>=0;--r)"reduce"===d[r].action.type&&(void 0===e&&(e={symbol:d[r].action.rule.lhs,children:[]}),y(e,d[r].action.rule));return e}());void 0!==r&&e.appendChild(r)}},this.sampleGrammar=function(){return"S' G\nG E = E\nG id\nE E + T\nE T\nT T * id\nT id"},this.sampleInput=function(){return"id = id + id * id"}}document.addEventListener("DOMContentLoaded",(function(){var e=new r(document),t=document.getElementById("grammar-text"),n=document.getElementById("input-text"),a={grammar:document.getElementById("grammar-container"),collection:document.getElementById("collection-container"),parseTable:document.getElementById("parse-table-container"),parseSteps:document.getElementById("parse-steps-container"),parseTree:document.getElementById("parse-tree-container")},i=function(){Object.keys(a).forEach((function(e){a[e].innerHTML=""}))},o=function(){i(),e.createParser(t.value),e.renderGrammar(a.grammar),e.renderCollection(a.collection),e.renderParseTable(a.parseTable)},l=function(){e.parse(n.value),e.renderParseSteps(a.parseSteps),e.renderParseTree(a.parseTree)};document.getElementById("create-parser").addEventListener("click",o),document.getElementById("parse").addEventListener("click",l),document.getElementById("show-example").addEventListener("click",(function(){t.value=e.sampleGrammar(),o(),n.value=e.sampleInput(),l()})),document.getElementById("clear").addEventListener("click",(function(){t.value="",n.value="",i(),e.clear()}))}))}();
//# sourceMappingURL=index.b8933e22.js.map
